<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Турнир по настольному теннису{% endblock %}</title>
    <meta name="color-scheme" content="light dark">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='img/favicon.png') }}">
    <link rel="shortcut icon" type="image/png" href="{{ url_for('static', filename='img/favicon.png') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='img/favicon.png') }}">
    <style>
        :root {
            --accent: #2563eb;
            --accent-2: #1d4ed8;
            --bg: #0b1020;
            --card: #0f172a;
            --muted: #94a3b8;
            --text: #e5e7eb;
            --border: #1f2a44;
        }
        * { box-sizing: border-box; }
        html, body { height: 100%; }
        body {
            margin: 0;
            font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial;
            background: radial-gradient(1200px 800px at 80% -20%, #0b1440 0%, var(--bg) 60%) fixed;
            color: var(--text);
        }
        .bg-video-wrapper { position: fixed; inset: 0; z-index: 0; overflow: hidden; }
        .bg-video { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; filter: brightness(0.45) saturate(110%); pointer-events: none; }
        .bg-overlay { position: fixed; inset: 0; z-index: 0; background: radial-gradient(1000px 600px at 0% 0%, rgba(37,99,235,0.18), rgba(0,0,0,0)); pointer-events: none; }
        /* Отключаем видеофон только при сниженной анимации */
        @media (prefers-reduced-motion: reduce) { .bg-video { display: none; } }
        .container { position: relative; z-index: 1; }
        a { color: var(--text); text-decoration: none; }
        a:hover { color: #fff; }
        .container { max-width: 1040px; margin: 0 auto; padding: 16px; }
        @media (min-width: 640px) { .container { padding: 20px; } }
        @media (min-width: 960px) { .container { padding: 24px; } }
        .nav {
            display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;
            background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            padding: 12px 16px; border-radius: 14px; margin: 16px 0 24px;
        }
        .brand { display:flex; align-items:center; gap:12px; font-weight: 800; letter-spacing: 0.3px; }
        
        .brand-title { display:flex; align-items:baseline; gap:8px; }
        .brand-title small { color: var(--muted); font-weight:600; }
        .nav a.btn { background: var(--accent); padding: 8px 12px; border-radius: 10px; color: #fff; }
        .nav a.btn.secondary { background: #0b1020; border: 1px solid var(--border); color: var(--text); }
        .nav a.btn.primary-strong { background: linear-gradient(90deg, var(--accent), var(--accent-2)); box-shadow: 0 6px 18px rgba(37,99,235,0.35); }
        .grid-cards { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        @media (min-width: 480px) { .grid-cards { grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 14px; } }
        @media (min-width: 640px) { .grid-cards { grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 16px; } }
        @media (min-width: 1200px) { .grid-cards { gap: 18px; } }
        .card { position: relative; overflow: hidden; background: linear-gradient(180deg, rgba(37,99,235,0.08), rgba(37,99,235,0.02)); border: 1px solid var(--border); border-radius: 16px; padding: 16px; transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease; }
        .card:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(0,0,0,0.25); border-color: rgba(37,99,235,0.45); }
        .card .name { margin-top:8px; font-weight:800; font-size:16px; }
        .card .meta { color: var(--muted); font-size:12px; }
        .card .badge { position:absolute; top:10px; right:10px; background: rgba(37,99,235,0.9); color:#fff; font-size:11px; font-weight:700; padding:4px 8px; border-radius:999px; border:1px solid var(--border); }
        .muted { color: var(--muted); }
        .headline { font-size: 28px; margin: 8px 0; }
        .lead { color: var(--muted); margin: 0 0 16px; }
        .form { background: rgba(15, 23, 42, 0.7); border: 1px solid var(--border); border-radius: 16px; padding: 20px; }
        label { display: block; margin-bottom: 14px; font-weight: 600; }
        input[type="text"], input[type="file"] {
            width: 100%; margin-top: 6px; padding: 12px 14px; border: 1px solid var(--border);
            background: #0b1020; color: var(--text); border-radius: 10px; font-size: 16px;
        }
        .actions { display: flex; gap: 10px; }
        button, .button { background: var(--accent); color: #fff; border: 0; padding: 12px 16px; border-radius: 12px; cursor: pointer; font-size: 16px; }
        button.secondary, .button.secondary { background: #0b1020; border: 1px solid var(--border); color: var(--text); }
        button.danger, .button.danger { background: #dc2626; }
        .flash { list-style: none; padding: 12px 16px; background: rgba(250, 204, 21, 0.12); border: 1px solid #facc15; border-radius: 12px; margin: 16px 0; }
        .table { width: 100%; border-collapse: collapse; display: table; }
        .table th, .table td { border-bottom: 1px solid var(--border); padding: 10px 8px; text-align: left; vertical-align: middle; }
        .table th { color: var(--muted); font-weight: 600; }
        .avatar { width: 100%; aspect-ratio: 1/1; object-fit: cover; border-radius: 12px; border: 1px solid var(--border); }
        .topbar { display: flex; gap: 12px; align-items: baseline; justify-content: space-between; }
        @media (max-width: 480px) {
          .topbar { flex-direction: column; align-items: flex-start; gap: 6px; }
          .actions { width: 100%; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }
          .nav .actions a.btn { width: 100%; text-align: center; }
        }
    </style>
    {% block head_extra %}{% endblock %}
    {% block styles_extra %}{% endblock %}
    {% block scripts_head %}{% endblock %}
    {% block meta %}{% endblock %}
</head>
<body>
{% if BACKGROUND_VIDEO_URL %}
  <div class="bg-video-wrapper" aria-hidden="true">
    <video class="bg-video" autoplay loop muted playsinline webkit-playsinline preload="metadata" poster="{{ BACKGROUND_POSTER_URL }}">
      {% if BACKGROUND_VIDEO_URL_WEBM %}
      <source src="{{ BACKGROUND_VIDEO_URL_WEBM }}" type="video/webm">
      {% endif %}
      <source src="{{ BACKGROUND_VIDEO_URL }}" type="video/mp4">
    </video>
  </div>
  <div class="bg-overlay"></div>
{% endif %}

<div class="container">
    <nav class="nav">
        <div class="brand">Турнир по настольному теннису</div>
        <div class="actions">
            <a class="btn secondary" href="{{ url_for('register_form') }}">Регистрация</a>
            <a class="btn primary-strong" href="{{ url_for('participants_list') }}">Зарегистрированные участники</a>
            <a class="btn secondary" href="{{ url_for('public_bracket') }}">Сетка</a>
            <a class="btn secondary" href="{{ url_for('organizers_list') }}">Организаторы</a>
            {% if session.get('is_admin') %}<a class="btn" href="{{ url_for('admin_index') }}">Админка</a>{% endif %}
        </div>
    </nav>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <ul class="flash">
          {% for m in messages %}<li>{{ m }}</li>{% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
</div>
{% if BACKGROUND_VIDEO_URL %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    var v = document.querySelector('.bg-video');
    if (!v) return;
    try { v.muted = true; } catch(e) {}
    var tryPlay = function(){ if (v.paused) { v.play().catch(function(){}); } };
    v.addEventListener('canplay', tryPlay);
    document.addEventListener('visibilitychange', tryPlay);
    tryPlay();
  });
</script>
{% endif %}
<script>
  // Countdown timer shared
  (function(){
    var el = document.getElementById('countdown');
    if (!el) return;
    var iso = el.getAttribute('data-start');
    if (!iso) return;
    var target = new Date(iso).getTime();
    var dEl = document.getElementById('cd-days');
    var hEl = document.getElementById('cd-hours');
    var mEl = document.getElementById('cd-mins');
    var sEl = document.getElementById('cd-secs');
    var tick = function(){
      var now = Date.now();
      var diff = Math.max(0, target - now);
      var s = Math.floor(diff/1000);
      var days = Math.floor(s/86400); s%=86400;
      var hrs = Math.floor(s/3600); s%=3600;
      var mins = Math.floor(s/60); var secs = s%60;
      if (dEl) dEl.textContent = String(days);
      if (hEl) hEl.textContent = String(hrs).padStart(2,'0');
      if (mEl) mEl.textContent = String(mins).padStart(2,'0');
      if (sEl) sEl.textContent = String(secs).padStart(2,'0');
    };
    tick();
    setInterval(tick, 1000);
  })();
  </script>
</body>
</html>



